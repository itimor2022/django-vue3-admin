import{a as Y,r as u,w as q,ak as l,o as x,c as C,X as t,u as c,H as I,b as v,R as a,S as g,Y as y,V as E,W as N,F as A,aj as K,ag as Q,aG as Z,aH as ee}from"./vue.5d8927be.js";import{g as te}from"./index.es.d2375c1e.js";import{J as oe,k as ae,y as S}from"./index.acfe672b.js";import{l as ne,d as le,a as se}from"./api.dbeb9b81.js";import{_ as ie}from"./_plugin-vue_export-helper.c27b6911.js";const de=h=>(Z("data-v-50724fd0"),h=h(),ee(),h),ce={class:"dept-tree-com"},re={class:"tc-head"},ue=de(()=>v("span",{class:"tc-head-txt"},"部门架构",-1)),pe={key:0,class:"text-center font-black font-normal"},fe={key:1,color:"var(--el-color-primary)"},_e={class:"tree-tags"},me=Y({__name:"index",props:{treeData:{default:()=>[]}},emits:["treeClick","deleteDept","updateDept"],setup(h,{expose:H,emit:B}){const F=te(K),R={children:"children",label:"name",isLeaf:(o,e)=>!e.data.hasChild},k=B;let p=u(""),r=u(!1),f=u(!1),s=u({}),V=u(null);const w=u();q(p,o=>{w.value.filter(o)});const M=(o,e)=>{var n;return o?((n=Q(e).name)==null?void 0:n.indexOf(o))!==-1:!0},P=(o,e)=>{o.level!==0&&ne({parent:o.data.id}).then(n=>{e(n.data)})},U=(o,e)=>{s.value=o,V.value=e,k("treeClick",o)},z=o=>{if(o==="update"){if(!s.value.id){S("请选择菜单！");return}k("updateDept",o,s.value)}else k("updateDept",o)},$=()=>{if(!s.value.id){S("请选择菜单！");return}k("deleteDept",s.value.id,()=>{s.value={}})},L=async o=>{var i;if(!s.value.id){S("请选择菜单！");return}if(f.value)return;const e=((i=V.value)==null?void 0:i.parent.childNodes)||[],n=e.findIndex(_=>_.data.id===s.value.id),D=e.find(_=>_.data.id===s.value.id);if(o==="up"){if(n===0)return;e.splice(n-1,0,D),e.splice(n+1,1),f.value=!0,await le({dept_id:s.value.id}),f.value=!1}o==="down"&&(e.splice(n+2,0,D),e.splice(n,1),f.value=!0,await se({dept_id:s.value.id}),f.value=!1)};return H({treeRef:w}),(o,e)=>{const n=l("el-input"),D=l("HomeFilled"),i=l("el-icon"),_=l("View"),j=l("Hide"),T=l("SvgIcon"),G=l("Plus"),m=l("el-tooltip"),J=l("Edit"),O=l("Top"),W=l("Bottom"),X=l("Delete");return x(),C(A,null,[t(n,{modelValue:c(p),"onUpdate:modelValue":e[0]||(e[0]=d=>I(p)?p.value=d:p=d),"prefix-icon":c(oe),placeholder:"请输入部门名称"},null,8,["modelValue","prefix-icon"]),v("div",ce,[v("div",re,[t(i,{size:"16",color:"#606266",class:"tc-head-icon"},{default:a(()=>[t(D)]),_:1}),ue,t(i,{size:"16",color:"#606266",onClick:e[1]||(e[1]=()=>I(r)?r.value=!c(r):r=!c(r)),class:"tc-head-icon"},{default:a(()=>[g(t(_,null,null,512),[[y,!c(r)]]),g(t(j,null,null,512),[[y,c(r)]])]),_:1})]),t(c(ae),{ref_key:"treeRef",ref:w,data:o.treeData,props:R,"filter-node-method":M,load:P,lazy:"",indent:38,onNodeClick:U,"highlight-current":""},{default:a(({node:d,data:b})=>[t(c(F),{node:d,showLabelLine:!1,indent:32},{default:a(()=>[b.status?(x(),C("span",pe,[t(T,{name:"iconfont icon-shouye",color:"var(--el-color-primary)"}),E(" "+N(d.label)+" ",1),g(v("span",null,"（"+N(b.dept_user_count)+"人）",513),[[y,c(r)]])])):(x(),C("span",fe,[t(T,{name:"iconfont icon-shouye"}),E(" "+N(d.label),1)]))]),_:2},1032,["node"])]),_:1},8,["data"]),v("div",_e,[t(m,{effect:"dark",content:"新增"},{default:a(()=>[t(i,{size:"16",onClick:e[2]||(e[2]=d=>z("create")),class:"mlt-icon"},{default:a(()=>[t(G)]),_:1})]),_:1}),t(m,{effect:"dark",content:"编辑"},{default:a(()=>[t(i,{size:"16",onClick:e[3]||(e[3]=d=>z("update")),class:"mlt-icon"},{default:a(()=>[t(J)]),_:1})]),_:1}),t(m,{effect:"dark",content:"上移"},{default:a(()=>[t(i,{size:"16",onClick:e[4]||(e[4]=d=>L("up")),class:"mlt-icon"},{default:a(()=>[t(O)]),_:1})]),_:1}),t(m,{effect:"dark",content:"下移"},{default:a(()=>[t(i,{size:"16",onClick:e[5]||(e[5]=d=>L("down")),class:"mlt-icon"},{default:a(()=>[t(W)]),_:1})]),_:1}),t(m,{effect:"dark",content:"删除"},{default:a(()=>[t(i,{size:"16",onClick:$,class:"mlt-icon"},{default:a(()=>[t(X)]),_:1})]),_:1})])])],64)}}});const xe=ie(me,[["__scopeId","data-v-50724fd0"]]);export{xe as default};
