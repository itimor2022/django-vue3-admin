import{S as z,d as R,m as h,r as E,t as L}from"./index.acfe672b.js";import{a as y,G as N,r as p,ak as _,as as $,o as x,c as b,X as a,R as e,K as j,V as n,b as d,u as i,S as D}from"./vue.5d8927be.js";const K={style:{display:"inline-block"}},O=d("i",{class:"el-icon-upload"},null,-1),q=d("div",{class:"el-upload__text"},[n(" 将文件拖到此处，或 "),d("em",null,"点击上传")],-1),A=d("div",{class:"el-upload__tip",style:{color:"red"}},"提示：仅允许导入“xls”或“xlsx”格式文件！",-1),G={class:"dialog-footer"},I=y({name:"importExcel"}),P=y({...I,props:{upload:{type:Object,default(){return{open:!0,title:"",isUploading:!1,updateSupport:0,headers:{Authorization:"JWT "+z.get("token")},url:R()+"api/system/file/"}}},api:{type:String,default(){}}},setup(k){const w=N("refreshView");let o=k,s=p(!1);const c=p(),r=p(!1),f=p(!1),V=function(){r.value=!0},C=function(){h({url:o.api+"import_data/",params:{},method:"get"})},S=function(){h({url:o.api+"update_template/",params:{},method:"get"})},B=function(u,t,l){f.value=!0},F=function(u,t,l){return f.value=!1,s.value=!0,c.value.clearFiles(),E({url:o.api+"import_data/",method:"post",data:{url:u.data.url}}).then(v=>{s.value=!1,L.alert("导入成功","导入完成",{confirmButtonText:"OK",callback:g=>{w()}})}).catch(()=>{s.value=!1})},T=function(){c.value.submit()};return(u,t)=>{const l=_("el-button"),v=_("el-upload"),g=_("el-dialog"),U=$("loading");return x(),b("div",K,[a(l,{size:"default",type:"success",onClick:t[0]||(t[0]=m=>V())},{default:e(()=>[j(u.$slots,"default",{},()=>[n("导入")])]),_:3}),a(g,{title:i(o).upload.title,modelValue:r.value,"onUpdate:modelValue":t[2]||(t[2]=m=>r.value=m),width:"400px","append-to-body":""},{footer:e(()=>[d("div",G,[a(l,{type:"primary",disabled:i(s),onClick:T},{default:e(()=>[n("确 定")]),_:1},8,["disabled"]),a(l,{disabled:i(s),onClick:t[1]||(t[1]=m=>r.value=!1)},{default:e(()=>[n("取 消")]),_:1},8,["disabled"])])]),default:e(()=>[D((x(),b("div",null,[a(v,{ref_key:"uploadRef",ref:c,limit:1,accept:".xlsx, .xls",headers:i(o).upload.headers,action:i(o).upload.url,disabled:f.value,"on-progress":B,"on-success":F,"auto-upload":!1,drag:""},{tip:e(()=>[A]),default:e(()=>[O,q]),_:1},8,["headers","action","disabled"]),d("div",null,[a(l,{type:"warning",style:{"font-size":"14px","margin-top":"20px"},onClick:C},{default:e(()=>[n("下载导入模板")]),_:1}),a(l,{type:"warning",style:{"font-size":"14px","margin-top":"20px"},onClick:S},{default:e(()=>[n("批量更新模板")]),_:1})])])),[[U,i(s)]])]),_:1},8,["title","modelValue"])])}}});export{P as _};
