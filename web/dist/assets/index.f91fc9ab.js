import{X as b,t as g,x as V}from"./index.acfe672b.js";import B from"./index.91ba17fa.js";import N from"./index.1f1f435d.js";import F from"./index.677cc3ad.js";import{G as M,D as A}from"./api.dbeb9b81.js";import{a as C,r as l,l as X,ak as c,o as x,Q as w,R as d,X as n,b as y,u as s,U as E,H as G}from"./vue.5d8927be.js";import{_ as j}from"./_plugin-vue_export-helper.c27b6911.js";import"./index.es.d2375c1e.js";import"./md5.b5efbca3.js";import"./crud.f93f339f.js";import"./dictionary.d76d7a20.js";import"./authFunction.88002d4f.js";import"./index.vue_vue_type_script_setup_true_name_importExcel_lang.665418ad.js";import"./echarts.30c674e7.js";const z={class:"dept-box dept-left"},H={class:"dept-box dept-table"},I=C({name:"dept"}),K=C({...I,setup(L){let p=l([]),_=l([]),o=l(!1),i=l({}),f=l(null),D=l(null);const m=async()=>{let e=await M({});if((e==null?void 0:e.code)===2e3&&Array.isArray(e.data)){const t=b.toArrayTree(e.data,{parentKey:"parent",children:"children"});p.value=t}},T=e=>{var t;(t=f.value)==null||t.handleDoRefreshUser(e.id)},U=(e,t)=>{g.confirm("您确认删除该部门吗?","温馨提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(async()=>{var r;const a=await A(e);t(),(a==null?void 0:a.code)===2e3&&(V(a.msg),m(),(r=f.value)==null||r.handleDoRefreshUser(""))})},k=(e,t)=>{var a,r;if(e==="update"&&t){const u=((r=(a=D.value)==null?void 0:a.treeRef)==null?void 0:r.currentNode.parent.data)||{};_.value=[u],i.value=t}o.value=!0},h=e=>{e==="submit"&&m(),o.value=!1,i.value={}};return X(()=>{m()}),(e,t)=>{const a=c("el-col"),r=c("el-row"),u=c("el-drawer"),R=c("fs-page");return x(),w(R,null,{default:d(()=>[n(r,{class:"dept-el-row"},{default:d(()=>[n(a,{span:6},{default:d(()=>[y("div",z,[n(B,{ref_key:"deptTreeRef",ref:D,treeData:s(p),onTreeClick:T,onUpdateDept:k,onDeleteDept:U},null,8,["treeData"])])]),_:1}),n(a,{span:18},{default:d(()=>[y("div",H,[n(F,{ref_key:"deptUserRef",ref:f},null,512)])]),_:1})]),_:1}),n(u,{modelValue:s(o),"onUpdate:modelValue":t[0]||(t[0]=v=>G(o)?o.value=v:o=v),title:"部门配置",direction:"rtl",size:"500px","close-on-click-modal":!1,"before-close":h},{default:d(()=>[s(o)?(x(),w(N,{key:0,initFormData:s(i),treeData:s(p),cacheData:s(_),onDrawerClose:h},null,8,["initFormData","treeData","cacheData"])):E("",!0)]),_:1},8,["modelValue"])]),_:1})}}});const re=j(K,[["__scopeId","data-v-35df331d"]]);export{re as default};
